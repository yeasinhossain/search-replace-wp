!function(s){"use strict";function r(e,a,i,t){s.ajax({type:"POST",url:srwp_object_vars.endpoint+e,data:{srwp_ajax_nonce:srwp_object_vars.ajax_nonce,action:e,srwp_step:a,srwp_page:i,srwp_data:t},dataType:"json",success:function(a){void 0!==a.message&&(s(".srwp-description").remove(),s(".srwp-progress-wrap").append('<p class="description srwp-description">'+a.message+"</p>")),"done"==a.step?(o("100%"),void 0!==a.next_action?(o("0%",0),r(a.next_action,0,0,a.srwp_data)):(s(".srwp-processing-wrap").remove(),s(".srwp-disabled").removeClass("srwp-disabled button-disabled"),window.location=a.url)):(o(a.percentage),r(e,a.step,a.page,a.srwp_data))}}).fail(function(r){s(".srwp-processing-wrap").remove(),s(".srwp-disabled").removeClass("srwp-disabled button-disabled"),s("#srwp-error-wrap").html('<div class="error"><p>'+srwp_object_vars.unknown+"</p></div>"),window.console&&window.console.log&&console.log(r)})}function e(){var e=s("#srwp-backup-submit");e.click(function(a){if(a.preventDefault(),!e.hasClass("button-disabled")){var i=s(".srwp-action-form").serialize();e.addClass("srwp-disabled button-disabled"),s("#srwp-backup-form").append('<div class="srwp-processing-wrap"><div class="spinner is-active srwp-spinner"></div><div class="srwp-progress-wrap"><div class="srwp-progress"></div></div></div>'),s(".srwp-progress-wrap").append('<p class="description srwp-description">'+srwp_object_vars.processing+"</p>"),r("process_backup",0,0,i)}})}function a(){var e=s("#srwp-import-submit");e.click(function(a){a.preventDefault();var i=s("#srwp-file-import").prop("files")[0],o=s("#srwp_import_profile").val(),t=new FormData;t.append("srwp_import_file",i),t.append("action","upload_import"),t.append("profile",o),t.append("srwp_ajax_nonce",srwp_object_vars.ajax_nonce),s.ajax({url:srwp_object_vars.endpoint+"upload_import",dataType:"json",cache:!1,contentType:!1,processData:!1,data:t,type:"post",success:function(a){"manual"===a.upload_method?confirm("No upload was detected, but an existing backup file was detected at "+a.file+". Do you want to import it?")&&(e.hasClass("button-disabled")||(e.addClass("srwp-disabled button-disabled"),s("#srwp-import-form").append('<div class="srwp-processing-wrap"><div class="spinner is-active srwp-spinner"></div><div class="srwp-progress-wrap"><div class="srwp-progress"></div></div></div>'),s(".srwp-progress-wrap").append('<p class="description srwp-description">Importing database...</p>'),r("process_import",0,0,a))):"ajax"==a.upload_method?e.hasClass("button-disabled")||(e.addClass("srwp-disabled button-disabled"),s("#srwp-import-form").append('<div class="srwp-processing-wrap"><div class="spinner is-active srwp-spinner"></div><div class="srwp-progress-wrap"><div class="srwp-progress"></div></div></div>'),s(".srwp-progress-wrap").append('<p class="description srwp-description">Importing database...</p>'),r("process_import",0,0,a)):alert("Please upload a valid backup file, or try increasing the max upload size.")}}).fail(function(s){window.console&&window.console.log&&console.log(s)})})}function i(){var e=s("#srwp-submit"),a=s("#srwp-error-wrap");e.click(function(i){if(i.preventDefault(),!e.hasClass("button-disabled"))if(s("#search_for").val())if(s("#srwp-table-select").val()){var o=s(".srwp-action-form").serialize().replace(/%5C/g,"#SRWP_BACKSLASH#");a.html(""),e.addClass("srwp-disabled button-disabled"),s("#srwp-submit-wrap").append('<div class="srwp-processing-wrap"><div class="spinner is-active srwp-spinner"></div><div class="srwp-progress-wrap"><div class="srwp-progress"></div></div></div>'),s(".srwp-progress-wrap").append('<p class="description srwp-description">'+srwp_object_vars.processing+"</p>"),r("process_search_replace",0,0,o)}else a.html('<div class="error"><p>'+srwp_object_vars.no_tables+"</p></div>");else a.html('<div class="error"><p>'+srwp_object_vars.no_search+"</p></div>")})}function o(r,e){void 0===e&&(e=150),s(".srwp-progress").animate({width:r},e)}function t(r){s("#srwp-page-size-slider").slider({value:srwp_object_vars.page_size,range:"min",min:1e3,max:5e4,step:1e3,slide:function(r,e){s("#srwp-page-size-value").text(e.value),s("#srwp_page_size").val(e.value)}}),s("#srwp-max-results-slider").slider({value:srwp_object_vars.max_results,range:"min",min:20,max:1e3,step:20,slide:function(r,e){s("#srwp-max-results-value").text(e.value),s("#srwp_max_results").val(e.value)}})}function n(){s("#save_profile").change(function(){this.checked?s(this).closest("tr").next("tr").fadeIn("fast"):s(this).closest("tr").next("tr").fadeOut("fast")})}e(),a(),i(),t(),n()}(jQuery);